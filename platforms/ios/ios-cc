#!/bin/sh

if [ -z "$REMCPE_TARGET" ]; then
    printf 'Do not run this script directly!\n'
    exit 1
fi

case $0 in
    *++) cc="clang++" ;;
    *)   cc="clang"   ;;
esac

case $REMCPE_TARGET in
    (arm64*-apple-macos*) stdlib=libc++ ;;
    (*) stdlib=libstdc++ ;;
esac

command -v ccache > /dev/null && ccache=ccache

exec $ccache "$cc" \
    -mlinker-version=762 \
    -stdlib="$stdlib" \
    "$@" \
    -isysroot "$REMCPE_SDK" \
    -target "$REMCPE_TARGET" \
    -fuse-ld=ld64 \
    -Wno-unused-command-line-argument
